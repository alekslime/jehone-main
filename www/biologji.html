<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biologji - Jehon√´</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Light mode colors */
            --primary-purple: #8c7acb;
            --secondary-purple: #68489a;
            --dark-purple: #4f258d;
            --light-purple: #abb4f9;
            --bg-primary: linear-gradient(135deg, #8c7acb 0%, #68489a 50%, #4f258d 100%);
            --bg-secondary: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
            --card-bg: rgba(255, 255, 255, 0.15);
            --border-color: rgba(255, 255, 255, 0.2);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --blur: blur(10px);
        }

        [data-theme="dark"] {
            /* Dark mode colors */
            --bg-primary: linear-gradient(135deg, #2a1f3d 0%, #1a1625 50%, #0f0a1a 100%);
            --bg-secondary: rgba(0, 0, 0, 0.3);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --card-bg: rgba(0, 0, 0, 0.4);
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* Added animated background elements */
        body::before,
        body::after {
            content: '';
            position: fixed;
            border-radius: 50%;
            pointer-events: none;
            z-index: -1;
        }

        body::before {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, var(--light-purple) 0%, transparent 70%);
            top: -150px;
            right: -150px;
            animation: floatShapes 20s ease-in-out infinite;
            opacity: 0.8;
        }

        body::after {
            width: 250px;
            height: 250px;
            background: radial-gradient(circle, var(--primary-purple) 0%, transparent 70%);
            bottom: -125px;
            left: -125px;
            animation: floatCircle 25s ease-in-out infinite reverse;
            opacity: 0.7;
        }

        .floating-shape {
            position: fixed;
            border-radius: 50%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.6;
        }

        .floating-shape:nth-child(1) {
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, var(--secondary-purple) 0%, transparent 70%);
            top: 20%;
            left: 10%;
            animation: morphShape 30s ease-in-out infinite;
        }

        .floating-shape:nth-child(2) {
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, var(--dark-purple) 0%, transparent 70%);
            top: 60%;
            right: 15%;
            animation: floatShapes 35s ease-in-out infinite reverse;
            animation-delay: -10s;
        }

        .floating-shape:nth-child(3) {
            width: 180px;
            height: 180px;
            background: radial-gradient(circle, var(--light-purple) 0%, transparent 70%);
            bottom: 30%;
            left: 20%;
            animation: floatCircle 28s ease-in-out infinite;
            animation-delay: -15s;
        }

        @keyframes floatShapes {
            0%, 100% { transform: translate(0, 0) rotate(0deg) scale(1); }
            25% { transform: translate(30px, -30px) rotate(90deg) scale(1.1); }
            50% { transform: translate(-20px, 20px) rotate(180deg) scale(0.9); }
            75% { transform: translate(40px, 10px) rotate(270deg) scale(1.05); }
        }

        @keyframes floatCircle {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(50px, -40px) scale(1.2); }
            66% { transform: translate(-30px, 30px) scale(0.8); }
        }

        @keyframes morphShape {
            0%, 100% { transform: translate(0, 0) rotate(0deg); border-radius: 50%; }
            25% { transform: translate(20px, -20px) rotate(45deg); border-radius: 30% 70% 70% 30%; }
            50% { transform: translate(-15px, 25px) rotate(90deg); border-radius: 70% 30% 30% 70%; }
            75% { transform: translate(35px, 5px) rotate(135deg); border-radius: 40% 60% 60% 40%; }
        }

        /* Navigation */
        .navbar {
            background: var(--card-bg);
            backdrop-filter: var(--blur);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: var(--text-primary);
            font-weight: 700;
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }

        .nav-brand:hover {
            transform: translateY(-2px);
            color: var(--primary-purple);
        }

        .brand-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: var(--primary-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .nav-brand:hover .brand-icon {
            transform: rotate(10deg) scale(1.1);
            box-shadow: 0 8px 25px rgba(140, 122, 203, 0.4);
        }

        .bookuliks {
            width: 24px;
            height: 24px;
        }

        .nav-menu {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .nav-link:hover::before {
            left: 100%;
        }

        .nav-link:hover {
            color: var(--text-primary);
            background: var(--bg-secondary);
            transform: translateY(-2px);
        }

        .theme-toggle {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: var(--blur);
        }

        .theme-toggle:hover {
            transform: scale(1.1) rotate(180deg);
            background: var(--primary-purple);
            box-shadow: 0 8px 25px rgba(140, 122, 203, 0.4);
        }

        .theme-icon {
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .profile-dropdown {
            position: relative;
        }

        .profile-button {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--primary-purple);
            border: 2px solid var(--border-color);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(140, 122, 203, 0.4);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--card-bg);
            backdrop-filter: var(--blur);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 0.5rem;
            min-width: 150px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .dropdown-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            width: 100%;
            padding: 0.75rem 1rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            text-align: left;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dropdown-item:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
            transform: translateX(5px);
        }

        .hamburger {
            display: none;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Subject Header */
        .subject-header {
            padding: 4rem 0;
            text-align: center;
            position: relative;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .subject-header-content {
            background: var(--card-bg);
            backdrop-filter: var(--blur);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            padding: 3rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .subject-header-content:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        }

        .subject-icon-large {
            font-size: 4rem;
            margin-bottom: 1rem;
            display: inline-block;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .hdbtn {
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .hdbtn:hover {
            transform: scale(1.05);
        }

        .subject-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary-purple), var(--light-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subject-description {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .subject-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 2rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 16px;
            backdrop-filter: var(--blur);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .stat-item:hover {
            transform: translateY(-5px) scale(1.05);
            background: var(--primary-purple);
            box-shadow: 0 15px 40px rgba(140, 122, 203, 0.3);
        }

        .stat-number {
            display: block;
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        /* Topics Section */
        .topics-section {
            padding: 4rem 0;
        }

        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-header h2 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .section-header p {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        .topics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .topic-card {
            background: var(--card-bg);
            backdrop-filter: var(--blur);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 2rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .topic-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.6s ease;
        }

        .topic-card:hover::before {
            left: 100%;
        }

        .topic-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.2);
            border-color: var(--primary-purple);
        }

        .progress-indicator {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--primary-purple);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .topic-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .topic-icon {
            font-size: 2.5rem;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .topic-info h3 {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .topic-duration {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .topic-description {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .topic-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .play-btn {
            flex: 1;
            background: linear-gradient(135deg, var(--primary-purple), var(--secondary-purple));
            border: none;
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .play-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.6s ease;
        }

        .play-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(140, 122, 203, 0.4);
        }

        .bookmark-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: var(--blur);
        }

        .bookmark-btn:hover {
            background: var(--primary-purple);
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 8px 25px rgba(140, 122, 203, 0.3);
        }

        /* Audio Player */
        .audio-player {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 350px;
            background: var(--card-bg);
            backdrop-filter: var(--blur);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transform: translateY(100px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .audio-player.show {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }

        .top {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .thumb {
            width: 50px;
            height: 50px;
            background: var(--primary-purple);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .title-info {
            flex: 1;
        }

        .title-info h4 {
            color: var(--text-primary);
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .title-info span {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            color: var(--text-primary);
            transform: scale(1.2);
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .controls button {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary);
        }

        .controls button:hover {
            background: var(--primary-purple);
            transform: scale(1.1);
        }

        .controls .play {
            background: var(--primary-purple);
            width: 50px;
            height: 50px;
        }

        .volume-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex: 1;
        }

        .volume-bar {
            flex: 1;
            height: 4px;
            background: var(--bg-secondary);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
        }

        .progress-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .time {
            color: var(--text-secondary);
            font-size: 0.8rem;
            min-width: 35px;
        }

        .progress-bar {
            flex: 1;
            height: 4px;
            background: var(--bg-secondary);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
        }

        /* AI Chatbot */
        .ai-chatbot {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            width: 400px;
            height: 500px;
            background: var(--card-bg);
            backdrop-filter: var(--blur);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            transform: translateY(100px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .ai-chatbot.show {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }

        .chatbot-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .chatbot-avatar {
            width: 45px;
            height: 45px;
            background: var(--primary-purple);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .chatbot-info {
            flex: 1;
        }

        .chatbot-info h4 {
            color: var(--text-primary);
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }

        .chatbot-status {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .chatbot-controls {
            display: flex;
            gap: 0.5rem;
        }

        .chatbot-voice-btn,
        .chatbot-minimize {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary);
        }

        .chatbot-voice-btn:hover,
        .chatbot-minimize:hover {
            background: var(--primary-purple);
            transform: scale(1.1);
        }

        .chatbot-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-purple) transparent;
        }

        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--primary-purple);
            border-radius: 3px;
        }

        .message {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
            align-items: flex-start;
        }

        .message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .ai-message .message-avatar {
            background: var(--primary-purple);
        }

        .user-message .message-avatar {
            background: var(--bg-secondary);
        }

        .user-message {
            flex-direction: row-reverse;
        }

        .message-content {
            flex: 1;
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 0.75rem;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-width: calc(100% - 50px);
        }

        .ai-message .message-content {
            background: var(--primary-purple);
            color: white;
        }

        .user-message .message-content {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
        }

        .message-content p {
            margin: 0;
            line-height: 1.4;
            word-break: break-word;
            hyphens: auto;
        }

        .message-actions {
            margin-top: 0.5rem;
            display: flex;
            gap: 0.5rem;
        }

        .play-message-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 6px;
            padding: 0.25rem 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-size: 0.8rem;
        }

        .play-message-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .chat-input-container {
            padding: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .chat-input-wrapper {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .chat-input {
            flex: 1;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 0.75rem;
            color: var(--text-primary);
            outline: none;
            transition: all 0.3s ease;
        }

        .chat-input:focus {
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px rgba(140, 122, 203, 0.1);
        }

        .chat-voice-input,
        .chat-send-btn {
            background: var(--primary-purple);
            border: none;
            border-radius: 12px;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .chat-voice-input:hover,
        .chat-send-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(140, 122, 203, 0.4);
        }

        .quick-questions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .quick-question {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 0.5rem 1rem;
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-question:hover {
            background: var(--primary-purple);
            color: white;
            transform: translateY(-2px);
        }

        .chatbot-toggle-btn {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            width: 60px;
            height: 60px;
            background: var(--primary-purple);
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
            z-index: 999;
        }

        .chatbot-toggle-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(140, 122, 203, 0.4);
        }

        .chatbot-icon {
            font-size: 1.5rem;
            color: white;
        }

        .chatbot-notification {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4757;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }

            .hamburger {
                display: block;
            }

            .subject-header-content {
                padding: 2rem;
            }

            .subject-title {
                font-size: 2rem;
            }

            .subject-stats {
                flex-direction: column;
                gap: 1rem;
            }

            .topics-grid {
                grid-template-columns: 1fr;
            }

            .audio-player {
                width: calc(100% - 2rem);
                right: 1rem;
                left: 1rem;
            }

            .ai-chatbot {
                width: calc(100% - 2rem);
                left: 1rem;
                height: 400px;
            }
        }

        /* Added floating shapes to body */
        .floating-shape {
            position: fixed;
            border-radius: 50%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.8;
        }

        .listening-indicator {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: var(--primary-purple);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            z-index: 1001;
        }

        .listening-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }

        .listening-indicator.active {
            background: #ff4444;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Adding modern Uliks voice assistant modal styles */
        .uliks-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #4f258d 0%, #68489a 25%, #8c7acb 75%, #abb4f9 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(20px);
        }

        .uliks-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .uliks-modal.active .uliks-content {
            transform: scale(1);
            opacity: 1;
        }

        .uliks-content {
            text-align: center;
            color: white;
            transform: scale(0.8);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) 0.1s;
            max-width: 600px;
            padding: 2rem;
        }

        .uliks-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            margin: 0 auto 2rem;
            animation: pulse-glow 2s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 0 50px rgba(255, 255, 255, 0.5);
            }
        }

        .uliks-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #ffffff, #abb4f9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .uliks-status {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .wave-container {
            width: 300px;
            height: 80px;
            margin: 2rem auto;
            position: relative;
            overflow: hidden;
        }

        .flowing-wave {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .flowing-wave.active {
            opacity: 1;
        }

        .wave-path {
            position: absolute;
            top: 50%;
            left: -100%;
            width: 200%;
            height: 4px;
            border-radius: 2px;
            animation: flow 3s ease-in-out infinite;
        }

        .wave-path:nth-child(1) {
            background: linear-gradient(90deg, transparent, #4f258d, transparent);
            animation-delay: 0s;
        }

        .wave-path:nth-child(2) {
            background: linear-gradient(90deg, transparent, #68489a, transparent);
            animation-delay: 0.5s;
            top: 45%;
        }

        .wave-path:nth-child(3) {
            background: linear-gradient(90deg, transparent, #8c7acb, transparent);
            animation-delay: 1s;
            top: 55%;
        }

        .wave-path:nth-child(4) {
            background: linear-gradient(90deg, transparent, #abb4f9, transparent);
            animation-delay: 1.5s;
            top: 40%;
        }

        .wave-path:nth-child(5) {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            animation-delay: 2s;
            top: 60%;
        }

        @keyframes flow {
            0% {
                left: -100%;
                transform: translateY(0) scaleY(1);
            }
            50% {
                left: 0%;
                transform: translateY(-10px) scaleY(1.5);
            }
            100% {
                left: 100%;
                transform: translateY(0) scaleY(1);
            }
        }

        .uliks-close {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .uliks-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .uliks-commands {
            margin-top: 2rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
        }

        .command-chip {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            color: white;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .command-chip:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .uliks-content {
                padding: 1rem;
            }
            
            .uliks-title {
                font-size: 2rem;
            }
            
            .wave-container {
                width: 250px;
                height: 60px;
            }
            
            .uliks-close {
                top: 1rem;
                right: 1rem;
                width: 40px;
                height: 40px;
            }
        }
    </style>
</head>
<body>
    <!-- Added floating background shapes -->
    <div class="floating-shape"></div>
    <div class="floating-shape"></div>
    <div class="floating-shape"></div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-brand">
                <div class="brand-icon">
                    <img class="bookuliks" src="images/logo transparent.png" alt="">
                </div>
                <span class="brand-text">Jehon√´</span>
            </a>
            
            <button class="hamburger" id="hamburgerToggle" onclick="toggleMobileMenu()">
                ‚ò∞
            </button>

            <div class="nav-menu"> 
                <a href="index.html" class="nav-link">Kryefaqja</a>
                <a href="index.html#subjects" class="nav-link">L√´nd√´t</a>
                <a href="index.html#about" class="nav-link">Rreth Nesh</a>
                <button class="theme-toggle" onclick="toggleTheme()">
                    <span class="theme-icon">üåô</span>
                </button>
                <div class="profile-dropdown">
                <button id="profileButton" class="profile-button" aria-haspopup="true" aria-expanded="false">
                    <span id="profileInitial">U</span>
                </button>
                <div class="dropdown-menu" id="profileMenu" role="menu">
                    <button class="dropdown-item" id="goPremium">Go Premium</button>
                    <button class="dropdown-item" id="logout">Log Out</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Subject Header -->
    <section class="subject-header">
        <div class="container">
            <div class="subject-header-content">
                <span class="subject-icon-large">üß¨</span>
                <button class="hdbtn" onclick="startListening()">
                <h1 class="subject-title">Biologji</h1>
                </button>
                <p class="subject-description">
                    Zbulo bot√´n e mahnitshme t√´ shkenc√´s s√´ jet√´s, nga qelizat m√´ t√´ vogla deri te ekosistemet komplekse
                </p>
                
                <div class="subject-stats">
                    <div class="stat-item">
                        <span class="stat-number">12</span>
                        <span class="stat-label">Kapituj</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">45</span>
                        <span class="stat-label">Or√´ Audio</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">150+</span>
                        <span class="stat-label">Koncepte</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Topics Section -->
    <section class="topics-section">
        <div class="container">
            <div class="section-header">
                <h2>Kapitujt e Biologjis√´</h2>
                <p>Zgjidhni kapitullin q√´ d√´shironi t√´ m√´soni</p>
            </div>

            <div class="topics-grid">
                <div class="topic-card" data-topic="berthama">
                    <div class="progress-indicator">25%</div>
                    <div class="topic-header">
                        <div class="topic-icon">üß¨</div>
                        <div class="topic-info">
                            <h3>P√´rmbajtja e B√´rtham√´s</h3>
                            <span class="topic-duration">2:15</span>
                        </div>
                    </div>
                    <p class="topic-description">
                        M√´soni p√´r struktur√´n dhe funksionin e b√´rtham√´s qelizore, ADN-n√´, ARN-n√´ dhe proceset e sintez√´s s√´ proteinave.
                    </p>
                    <div class="topic-actions">
                        <button class="play-btn" id="ber-btn" onclick="playSound(berthama)">
                            <span>‚ñ∂Ô∏è</span>
                            <span>D√´gjo Leksionin</span>
                        </button>
                        <button class="bookmark-btn" onclick="toggleBookmark(this)">
                            <span>üîñ</span>
                        </button>
                    </div>
                </div>

                <div class="topic-card" data-topic="riprodhimi">
                    <div class="topic-header">
                        <div class="topic-icon">üî¨</div>
                        <div class="topic-info">
                            <h3>Riprodhimi Seksual dhe Trash√´gimia</h3>
                            <span class="topic-duration">3:42</span>
                        </div>
                    </div>
                    <p class="topic-description">
                        Studiojeni proceset e riprodhimit seksual, meioz√´n, dhe mekanizmat e trash√´gimit t√´ karakteristikave.
                    </p>
                    <div class="topic-actions">
                        <button class="play-btn" onclick="playSound(riprodhimi)">
                            <span>‚ñ∂Ô∏è</span>
                            <span>D√´gjo Leksionin</span>
                        </button>
                        <button class="bookmark-btn" onclick="toggleBookmark(this)">
                            <span>üîñ</span>
                        </button>
                    </div>
                </div>

                <div class="topic-card" data-topic="variacioni">
                    <div class="topic-header">
                        <div class="topic-icon">üß™</div>
                        <div class="topic-info">
                            <h3>Variacioni dhe Trash√´gimia</h3>
                            <span class="topic-duration">2:58</span>
                        </div>
                    </div>
                    <p class="topic-description">
                        Eksploroni variacionet gjenetike, mutacionet, dhe rolin e tyre n√´ evolucion dhe diversitetin biologjik.
                    </p>
                    <div class="topic-actions">
                        <button class="play-btn" onclick="playSound(variacioni)">
                            <span>‚ñ∂Ô∏è</span>
                            <span>D√´gjo Leksionin</span>
                        </button>
                        <button class="bookmark-btn" onclick="toggleBookmark(this)">
                            <span>üîñ</span>
                        </button>
                    </div>
                </div>

                <div class="topic-card" data-topic="ekosistemi">
                    <div class="topic-header">
                        <div class="topic-icon">üå±</div>
                        <div class="topic-info">
                            <h3>Ekosistemet dhe Biodiversiteti</h3>
                            <span class="topic-duration">4:10</span>
                        </div>
                    </div>
                    <p class="topic-description">
                        Kuptoni marr√´dh√´niet komplekse n√´ natyr√´, zinxhir√´t ushqimor√´ dhe r√´nd√´sin√´ e biodiversitetit.
                    </p>
                    <div class="topic-actions">
                        <button class="play-btn" onclick="playSound(ekosistemi)">
                            <span>‚ñ∂Ô∏è</span>
                            <span>D√´gjo Leksionin</span>
                        </button>
                        <button class="bookmark-btn" onclick="toggleBookmark(this)">
                            <span>üîñ</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!--AUDIO PLAYER-->
    <div class="audio-player" id="audioPlayer">
    <div class="top">
      <div class="thumb"></div>
      <div class="title-info">
        <h4 id="trackTitle"></h4>
        <span>Biologji - Kapitulli 1</span>
      </div>
      <span class="close-btn" id="close-btn" onclick="togglePlayer()">&times;</span>
    </div>

    <div class="controls">
      <button onclick="rewind()">‚è™</button>
      <button class="play" onclick="togglePlay()">‚ñ∂</button>
      <button onclick="skip()">‚è©</button>
      <div class="volume-container">
        <span>üîä</span>
        <input type="range" id="volumeBar" class="volume-bar" min="0" max="1" step="0.01" value="1" onchange="setVolume(this.value)">
      </div>
      <span>1x</span>
    </div>

    <div class="progress-container">
      <span class="time" id="currentTime">0:00</span>
      <input type="range" id="progressBar" class="progress-bar" value="0" max="100" onchange="seekAudio(this.value)">
      <span class="time" id="duration">0:00</span>
    </div>
  </div>

    <!-- AI Chatbot -->
    <div class="ai-chatbot" id="aiChatbot">
        <div class="chatbot-header">
            <div class="chatbot-avatar">ü§ñ</div>
            <div class="chatbot-info">
                <h4>Jehon√´ AI Asistent</h4>
                <p class="chatbot-status" id="chatbotStatus">Online</p>
            </div>
            <div class="chatbot-controls">
                <button class="chatbot-voice-btn" onclick="toggleChatVoice()" id="chatVoiceBtn">
                    <span>üé§</span>
                </button>
                <button class="chatbot-minimize" onclick="toggleChatbot()">
                    <span id="chatbotToggleIcon">‚àí</span>
                </button>
            </div>
        </div>
        
        <div class="chatbot-content" id="chatbotContent">
            <div class="chat-messages" id="chatMessages">
                <div class="message ai-message">
                    <div class="message-avatar">ü§ñ</div>
                    <div class="message-content">
                        <p>P√´rsh√´ndetje! Un√´ jam Jehon√´ AI, asistenti juaj p√´r biologji. Mund t√´ m√´ pyesni √ßdo gj√´ rreth m√´simeve, koncepteve biologjike, ose ndihm√´ me detyrat. Si mund t'ju ndihmoj sot?</p>
                        <div class="message-actions">
                            <button class="play-message-btn" onclick="playMessage(this, 'P√´rsh√´ndetje! Un√´ jam Jehon√´ AI, asistenti juaj p√´r biologji. Mund t√´ m√´ pyesni √ßdo gj√´ rreth m√´simeve, koncepteve biologjike, ose ndihm√´ me detyrat. Si mund t\'ju ndihmoj sot?')">
                                <span>üîä</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Shkruani pyetjen tuaj k√´tu..." onkeypress="handleChatKeyPress(event)">
                    <button class="chat-voice-input" onclick="startChatVoiceInput()" id="chatVoiceInput">
                        <span>üé§</span>
                    </button>
                    <button class="chat-send-btn" onclick="sendChatMessage()">
                        <span>üì§</span>
                    </button>
                </div>
                <div class="quick-questions">
                    <button class="quick-question" onclick="askQuickQuestion('√áfar√´ √´sht√´ ADN-ja?')">√áfar√´ √´sht√´ ADN-ja?</button>
                    <button class="quick-question" onclick="askQuickQuestion('Si funksionon fotosinteza?')">Si funksionon fotosinteza?</button>
                    <button class="quick-question" onclick="askQuickQuestion('√áfar√´ √´sht√´ mitoza?')">√áfar√´ √´sht√´ mitoza?</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chatbot Toggle Button -->
    <button class="chatbot-toggle-btn" onclick="showChatbot()" id="chatbotToggleBtn">
        <span class="chatbot-icon">ü§ñ</span>
        <span class="chatbot-notification" id="chatbotNotification">1</span>
    </button>

    <!-- Adding Uliks voice assistant modal -->
    <div class="uliks-modal" id="uliksModal">
        <button class="uliks-close" onclick="closeUliks()">√ó</button>
        <div class="uliks-content">
            <div class="uliks-avatar">üé§</div>
            <h1 class="uliks-title">Uliks</h1>
            <p class="uliks-status" id="uliksStatus">Po ju d√´gjoj...</p>
            
            <div class="wave-container">
                <div class="flowing-wave" id="flowingWave">
                    <div class="wave-path"></div>
                    <div class="wave-path"></div>
                    <div class="wave-path"></div>
                    <div class="wave-path"></div>
                    <div class="wave-path"></div>
                </div>
            </div>
            
            <div class="uliks-commands">
                <div class="command-chip">Biologji</div>
                <div class="command-chip">Gjeografi</div>
                <div class="command-chip">Let√´rsi</div>
                <div class="command-chip">Ndihm√´</div>
            </div>
        </div>
    </div>

    <div class="listening-indicator" id="listeningIndicator">
        <span id="listeningText">üé§ Listening for "ULIX!"</span>
    </div>

    <script src="js/bio1.js" type="module"></script>
    <script src="auth.js" type="module"></script>
    <!-- Including Uliks voice assistant module -->
    <script src="index3.js" type="module"></script>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            
            const themeIcon = document.querySelector('.theme-icon');
            themeIcon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            
            localStorage.setItem('theme', newTheme);
        }

        // Load saved theme
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            const themeIcon = document.querySelector('.theme-icon');
            themeIcon.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        });

        // AI Chatbot functionality
        let chatbotVisible = false;
        let isListening = false;
        let recognition = null;
        let isWaitingForCommand = false;
        let currentLessonContext = "Biology lesson about cells, DNA, photosynthesis, and mitosis";

        // Initialize continuous voice recognition
        function initializeContinuousListening() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.continuous = true;
                recognition.interimResults = true;
                recognition.lang = 'sq-AL'; // Albanian

                recognition.onstart = function() {
                    isListening = true;
                    document.getElementById('listeningIndicator').classList.add('show');
                };

                recognition.onresult = function(event) {
                    let finalTranscript = '';
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        if (event.results[i].isFinal) {
                            finalTranscript += event.results[i][0].transcript;
                        }
                    }

                    if (finalTranscript.toLowerCase().includes('ulix')) {
                        handleWakeWord(finalTranscript);
                    } else if (isWaitingForCommand && finalTranscript.trim()) {
                        handleVoiceCommand(finalTranscript);
                        isWaitingForCommand = false;
                        document.getElementById('listeningIndicator').classList.remove('active');
                        document.getElementById('listeningText').textContent = 'üé§ Listening for "ULIX!"';
                    }
                };

                recognition.onerror = function(event) {
                    console.log('Speech recognition error:', event.error);
                    setTimeout(startContinuousListening, 1000);
                };

                recognition.onend = function() {
                    if (isListening) {
                        setTimeout(startContinuousListening, 100);
                    }
                };

                startContinuousListening();
            }
        }

        function startContinuousListening() {
            if (recognition && isListening) {
                try {
                    recognition.start();
                } catch (e) {
                    console.log('Recognition already started');
                }
            }
        }

        function handleWakeWord(transcript) {
            isWaitingForCommand = true;
            document.getElementById('listeningIndicator').classList.add('active');
            document.getElementById('listeningText').textContent = 'üé§ Listening for your question...';
            
            // Show chatbot if hidden
            if (!document.getElementById('aiChatbot').classList.contains('show')) {
                showChatbot();
            }

            // Play activation sound
            speak("Po ju d√´gjoj. √áfar√´ d√´shironi t√´ dini?");
        }

        function handleVoiceCommand(command) {
            addUserMessage(command);
            sendToChatGPT(command);
        }

        async function sendToChatGPT(userMessage) {
            const chatbotStatus = document.getElementById('chatbotStatus');
            chatbotStatus.textContent = 'Duke menduar...';

            try {
                // You'll need to replace this with your actual API endpoint
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: userMessage,
                        context: currentLessonContext,
                        language: 'Albanian'
                    })
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const data = await response.json();
                const aiResponse = data.response;

                addAIMessage(aiResponse);
                speak(aiResponse);
                
            } catch (error) {
                console.error('Error calling ChatGPT:', error);
                // Fallback to local responses
                const fallbackResponse = getBiologyResponse(userMessage);
                addAIMessage(fallbackResponse);
                speak(fallbackResponse);
            }

            chatbotStatus.textContent = 'Online';
        }

        // Enhanced local biology responses as fallback
        function getBiologyResponse(question) {
            const responses = {
                'adn': 'ADN-ja (Acidi Deoksiribonukleik) √´sht√´ molekula q√´ mban informacionin gjenetik n√´ t√´ gjitha organizmat e gjall√´. Ajo p√´rb√´het nga dy zinxhir√´ q√´ formojn√´ nj√´ spirale t√´ dyfisht√´.',
                'fotosintez': 'Fotosinteza √´sht√´ procesi ku bim√´t p√´rdorin drit√´n e diellit p√´r t√´ prodhuar ushqim nga dioksidi i karbonit dhe uji. Formula √´sht√´: 6CO‚ÇÇ + 6H‚ÇÇO + energji drite ‚Üí C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ + 6O‚ÇÇ',
                'mitoz': 'Mitoza √´sht√´ procesi i ndarjes s√´ qeliz√´s ku nj√´ qeliz√´ prind√´rore ndahet n√´ dy qeliza t√´ reja identike. Ajo ka kat√´r faza: profaza, metafaza, anafaza dhe telofaza.',
                'qeliz': 'Qeliza √´sht√´ nj√´sia baz√´ e jet√´s. Ajo p√´rmban organele t√´ ndryshme si b√´rthama, mitokondria, dhe ribozomat q√´ kryejn√´ funksione t√´ ndryshme.',
                'protein': 'Proteina jan√´ molekula t√´ m√´dha q√´ p√´rb√´hen nga aminoacide. Ato kryejn√´ shum√´ funksione n√´ organiz√´m si enzima, hormon√´ dhe struktur√´ qelizore.'
            };

            const lowerQuestion = question.toLowerCase();
            for (const [key, response] of Object.entries(responses)) {
                if (lowerQuestion.includes(key)) {
                    return response;
                }
            }

            return 'Faleminderit p√´r pyetjen! Kjo √´sht√´ nj√´ pyetje interesante p√´r biologjin√´. Mund t√´ m√´ jepni m√´ shum√´ detaje q√´ t√´ mund t\'ju ndihmoj m√´ mir√´?';
        }

        // Enhanced text-to-speech
        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'sq-AL';
                utterance.rate = 0.9;
                utterance.pitch = 1;
                speechSynthesis.speak(utterance);
            }
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                addUserMessage(message);
                sendToChatGPT(message);
                input.value = '';
            }
        }

        function askQuickQuestion(question) {
            addUserMessage(question);
            sendToChatGPT(question);
        }

        function toggleChatbot() {
            const chatbot = document.getElementById('aiChatbot');
            const toggleBtn = document.getElementById('chatbotToggleBtn');
            const toggleIcon = document.getElementById('chatbotToggleIcon');
            
            if (chatbot.classList.contains('show')) {
                chatbot.classList.remove('show');
                toggleBtn.style.display = 'flex';
                chatbotVisible = false;
                toggleIcon.textContent = '‚àí';
            } else {
                chatbot.classList.add('show');
                toggleBtn.style.display = 'none';
                chatbotVisible = true;
                toggleIcon.textContent = '‚àí';
            }
        }

        function showChatbot() {
            const chatbot = document.getElementById('aiChatbot');
            const toggleBtn = document.getElementById('chatbotToggleBtn');
            
            chatbot.classList.add('show');
            toggleBtn.style.display = 'none';
            chatbotVisible = true;
        }

        function addUserMessage(message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'user-message';
            messageDiv.innerHTML = `
                <div class="message-content">
                    <span class="message-icon">üë§</span>
                    <span class="message-text">${message}</span>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addAIMessage(message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'ai-message';
            messageDiv.innerHTML = `
                <div class="message-content">
                    <span class="message-icon">ü§ñ</span>
                    <span class="message-text">${message}</span>
                    <button class="play-message-btn" onclick="speak('${message.replace(/'/g, "\\'")}')">üîä</button>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeContinuousListening();
        });
    </script>
</body>
</html>
